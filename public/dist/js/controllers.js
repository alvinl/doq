var DoqApp=angular.module("DoqApp",["luegg.directives","ngSanitize"]);DoqApp.filter("toTrusted",["$sce",function(n){return function(o){return o=o.replace("(B",""),n.trustAsHtml(o)}}]),DoqApp.filter("parseRunning",function(){return function(n){return 1===n?n+" running app":n+" running apps"}}),DoqApp.controller("ActiveCtrl",["$scope","$http",function(n,o){o.get("/api/containers").success(function(o){n.activeContainers=o}).error(function(n){console.dir(n)})}]),DoqApp.controller("IndexCtrl",["$scope","$http","$window",function(n,o,r){n.runningContainers=0,n.variables={};var e=["PORT","APP_REPO"];o.get("/api/containers").success(function(o){n.runningContainers=o.filter(function(n){return n.Ports.length}).length}).error(function(n){console.dir(n)}),n.removeEnv=function(o){delete n.variables[o]},n.addVar=function(){if(n.key){if(~e.indexOf(n.key))return n.warning="Sorry, but "+n.key+" is a reserved environment variable";n.variables[n.key]=n.value,n.key="",n.value=""}},n.launchApp=function(){o.post("/api/launch",{url:n.appRepo,vars:n.variables}).success(function(n){r.location="/app/"+n.id.substring(0,12)}).error(function(o){console.dir(o),n.launchError="Sorry, there was an error launching your application."})}}]),DoqApp.controller("AppCtrl",["$scope","$http","$window","$anchorScroll","$location",function(n,o,r,e,t){if(n.appLog=[],n.appURL="null"!==n.containerPort?"http://"+t.host()+":"+n.containerPort:"#notRunning",n.deleteApp=function(){o.post("/api/delete",{containerID:n.containerHash}).success(function(){r.location="/"}).error(function(n){console.dir(n)})},n.relaunchApp=function(){o.post("/api/relaunch",{containerID:n.containerHash}).success(function(){r.location=r.location}).error(function(n){console.dir(n)})},window.EventSource){var i=new EventSource("/api/logs/"+n.containerHash);i.addEventListener("log",function(o){n.$apply(function(){n.appLog.push(JSON.parse(o.data))})})}}]);